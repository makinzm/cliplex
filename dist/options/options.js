(()=>{"use strict";var e={379:function(e,t){var n=this&&this.__awaiter||function(e,t,n,o){return new(n||(n=Promise))((function(d,i){function l(e){try{c(o.next(e))}catch(e){i(e)}}function a(e){try{c(o.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?d(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(l,a)}c((o=o.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.LocalDatabase=void 0,t.LocalDatabase=class{constructor(){this.STORAGE_KEY="word_entries",this.EXCLUDED_DOMAIN_KEY="excluded_domains",this.INCLUDED_DOMAIN_KEY="included_domains"}getAll(){return n(this,void 0,void 0,(function*(){console.log("Getting all entries from storage...");const e=yield chrome.storage.local.get(this.STORAGE_KEY);return console.log("All entries:",e),e[this.STORAGE_KEY]||[]}))}save(e){return n(this,void 0,void 0,(function*(){const t=yield this.getAll(),n=t.findIndex((t=>t.key===e.key));n>-1?t[n]=e:t.push(e),yield chrome.storage.local.set({[this.STORAGE_KEY]:t})}))}delete(e){return n(this,void 0,void 0,(function*(){const t=(yield this.getAll()).filter((t=>t.key!==e));yield chrome.storage.local.set({[this.STORAGE_KEY]:t})}))}getAllExcludedDomains(){return n(this,void 0,void 0,(function*(){return(yield chrome.storage.local.get(this.EXCLUDED_DOMAIN_KEY))[this.EXCLUDED_DOMAIN_KEY]||[]}))}addExcludedDomain(e){return n(this,void 0,void 0,(function*(){const t=yield this.getAllExcludedDomains();t.some((t=>t.domain===e))||(t.push({domain:e}),yield chrome.storage.local.set({[this.EXCLUDED_DOMAIN_KEY]:t}))}))}removeExcludedDomain(e){return n(this,void 0,void 0,(function*(){const t=(yield this.getAllExcludedDomains()).filter((t=>t.domain!==e));yield chrome.storage.local.set({[this.EXCLUDED_DOMAIN_KEY]:t})}))}getAllIncludedDomains(){return n(this,void 0,void 0,(function*(){return(yield chrome.storage.local.get(this.INCLUDED_DOMAIN_KEY))[this.INCLUDED_DOMAIN_KEY]||[]}))}addIncludedDomain(e){return n(this,void 0,void 0,(function*(){const t=yield this.getAllIncludedDomains();t.some((t=>t.domain===e))||(t.push({domain:e}),yield chrome.storage.local.set({[this.INCLUDED_DOMAIN_KEY]:t}))}))}removeIncludedDomain(e){return n(this,void 0,void 0,(function*(){const t=(yield this.getAllIncludedDomains()).filter((t=>t.domain!==e));yield chrome.storage.local.set({[this.INCLUDED_DOMAIN_KEY]:t})}))}}},115:function(e,t,n){var o=this&&this.__awaiter||function(e,t,n,o){return new(n||(n=Promise))((function(d,i){function l(e){try{c(o.next(e))}catch(e){i(e)}}function a(e){try{c(o.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?d(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(l,a)}c((o=o.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});const d=new(n(379).LocalDatabase);let i=[];const l=document.getElementById("dateFrom"),a=document.getElementById("dateTo"),c=document.getElementById("filterButton"),r=document.getElementById("prioritySort"),s=document.getElementById("wordsContainer");let u=1;const m=document.getElementById("pagination");function v(){return o(this,arguments,void 0,(function*(e={}){let t=yield d.getAll();e.from&&(t=t.filter((t=>new Date(t.addedDate)>=e.from))),e.to&&(t=t.filter((t=>new Date(t.addedDate)<=e.to))),e.prioritySort?t.sort(((t,n)=>"asc"===e.prioritySort?t.priority===n.priority?new Date(t.addedDate).getTime()-new Date(n.addedDate).getTime():t.priority-n.priority:t.priority===n.priority?new Date(n.addedDate).getTime()-new Date(t.addedDate).getTime():n.priority-t.priority)):t.sort(((e,t)=>e.priority===t.priority?new Date(t.addedDate).getTime()-new Date(e.addedDate).getTime():t.priority-e.priority)),i=t,u=1,g()}))}const p=document.getElementById("openModalButton"),y=document.getElementById("closeModalButton"),h=document.getElementById("modalOverlay");function E(e){const t=document.createElement("div");t.className="word-card";const n=document.createElement("div");n.className="word-header";const i=document.createElement("div");i.className="priority-section";const l=document.createElement("label");l.textContent="優先度:",i.appendChild(l);const a=document.createElement("select");a.className="priority-select",[5,4,3,2,1].forEach((t=>{const n=document.createElement("option");n.value=String(t),n.textContent=String(t),t===e.priority&&(n.selected=!0),a.appendChild(n)})),a.addEventListener("change",(()=>o(this,void 0,void 0,(function*(){e.priority=Number(a.value),yield d.save(e),console.log("優先度が変更されました:",e.key,e.priority),g()})))),i.appendChild(a),n.appendChild(i);const c=document.createElement("span");c.className="word-title",c.textContent=e.key,n.appendChild(c);const r=document.createElement("button");r.textContent="削除",r.className="delete-word-button",r.addEventListener("click",(()=>o(this,void 0,void 0,(function*(){confirm("本当に削除しますか?")&&(yield d.delete(e.key),v())})))),n.appendChild(r),t.appendChild(n);const u=document.createElement("ul");u.className="example-list",e.examples.forEach(((t,n)=>{const i=document.createElement("li");i.textContent=t;const l=document.createElement("button");l.textContent="編集",l.style.marginLeft="8px",l.addEventListener("click",(()=>o(this,void 0,void 0,(function*(){const o=prompt("新しい例文を入力してください:",t);null!==o&&""!==o.trim()&&(e.examples[n]=o.trim(),yield d.save(e),g())}))));const a=document.createElement("button");a.textContent="削除",a.style.marginLeft="8px",a.addEventListener("click",(()=>o(this,void 0,void 0,(function*(){confirm("本当に削除しますか?")&&(e.examples.splice(n,1),yield d.save(e),g())})))),i.appendChild(a),i.appendChild(l),u.appendChild(i)}));const m=document.createElement("button");m.className="add-example-button",m.textContent="例文を追加",m.addEventListener("click",(()=>o(this,void 0,void 0,(function*(){const t=prompt("新しい例文を入力してください:");t&&(e.examples.push(t),yield d.save(e),g())})))),t.appendChild(u),t.appendChild(m);const p=document.createElement("div");p.className="note-section";const y=document.createElement("textarea");y.rows=2,y.cols=30,y.value=e.note||"",y.addEventListener("change",(()=>o(this,void 0,void 0,(function*(){e.note=y.value,yield d.save(e),console.log("メモが更新されました:",e.key,e.note)})))),p.appendChild(y),t.appendChild(p);const h=document.createElement("div");h.className="word-links",[{name:"Oxford",url:`https://www.oxfordlearnersdictionaries.com/definition/english/${e.key}`},{name:"Weblio",url:`https://ejje.weblio.jp/content/${e.key}`},{name:"Youglish",url:`https://youglish.com/pronounce/${e.key}/english`},{name:"Play Phrase",url:`https://playphrase.me/#/search?q=${e.key}`}].forEach((({name:e,url:t})=>{const n=document.createElement("a");n.href=t,n.target="_blank",n.textContent=e,h.appendChild(n)})),t.appendChild(h);const E=document.createElement("div");E.style.fontSize="0.8em",E.style.marginTop="5px",E.textContent=`追加日: ${new Date(e.addedDate).toLocaleString()}`,t.appendChild(E),s.appendChild(t)}function g(){s.innerHTML="",Math.ceil(i.length/5);const e=5*(u-1),t=e+5;i.slice(e,t).forEach((e=>{E(e)})),function(){m.innerHTML="";const e=Math.ceil(i.length/5),t=document.createElement("button");t.textContent="前へ",t.className="pagination-button",t.disabled=1===u,t.addEventListener("click",(()=>{u>1&&(u--,g())})),m.appendChild(t);const n=document.createElement("button");n.textContent="次へ",n.className="pagination-button",n.disabled=u===e,n.addEventListener("click",(()=>{u<e&&(u++,g())})),m.appendChild(n)}()}p.addEventListener("click",(()=>{h.style.display="flex"})),y.addEventListener("click",(()=>{h.style.display="none"})),h.addEventListener("click",(e=>{e.target===h&&(h.style.display="none")})),document.getElementById("addNewWordButton").addEventListener("click",(()=>o(void 0,void 0,void 0,(function*(){const e=document.getElementById("newWordKey").value.trim(),t=document.getElementById("newWordExamples").value.split(",").map((e=>e.trim())).filter((e=>e)),n=document.getElementById("newWordNote").value.trim(),o=parseInt(document.getElementById("newWordPriority").value);if(!e)return void alert("単語を入力してください！");const i={key:e,examples:t,note:n,priority:o,addedDate:(new Date).toISOString()};yield d.save(i),E(i),h.style.display="none",v(),document.getElementById("newWordKey").value="",document.getElementById("newWordExamples").value="",document.getElementById("newWordNote").value="",document.getElementById("newWordPriority").value="3"})))),c.addEventListener("click",(()=>{v({from:l.value?new Date(l.value):void 0,to:a.value?new Date(a.value):void 0,prioritySort:r.value})})),r.addEventListener("change",(()=>{v({from:l.value?new Date(l.value):void 0,to:a.value?new Date(a.value):void 0,prioritySort:r.value})}));const f=document.getElementById("excludedDomainInput"),D=document.getElementById("addExcludedDomainButton"),x=document.getElementById("excludedDomainList");function I(){return o(this,void 0,void 0,(function*(){const e=yield d.getAllExcludedDomains();x.innerHTML="";for(const t of e){const e=document.createElement("li");e.textContent=t.domain;const n=document.createElement("button");n.textContent="削除",n.addEventListener("click",(()=>o(this,void 0,void 0,(function*(){yield d.removeExcludedDomain(t.domain),I()})))),e.appendChild(n),x.appendChild(e)}}))}D.addEventListener("click",(()=>o(void 0,void 0,void 0,(function*(){const e=f.value.trim();e&&(yield d.addExcludedDomain(e),f.value="",I())}))));const C=document.getElementById("includedDomainInput"),w=document.getElementById("addIncludedDomainButton"),L=document.getElementById("includedDomainList");function _(){return o(this,void 0,void 0,(function*(){const e=yield d.getAllIncludedDomains();L.innerHTML="";for(const t of e){const e=document.createElement("li");e.textContent=t.domain;const n=document.createElement("button");n.textContent="削除",n.addEventListener("click",(()=>o(this,void 0,void 0,(function*(){yield d.removeIncludedDomain(t.domain),_()})))),e.appendChild(n),L.appendChild(e)}}))}w.addEventListener("click",(()=>o(void 0,void 0,void 0,(function*(){const e=C.value.trim();e&&(yield d.addIncludedDomain(e),C.value="",_())}))));const k="domainFilterMode",B=document.getElementById("radioExclude"),N=document.getElementById("radioInclude"),A=document.getElementById("excludeSettings"),b=document.getElementById("includeSettings");function M(e){"exclude"===e?(A.style.display="block",b.style.display="none"):(A.style.display="none",b.style.display="block"),localStorage.setItem("domainFilterMode",e)}B.addEventListener("change",(()=>M("exclude"))),N.addEventListener("change",(()=>M("include"))),"exclude"===(localStorage.getItem("domainFilterMode")||"include")?(B.checked=!0,M("exclude")):(N.checked=!0,M("include")),I(),_(),v(),function(){o(this,void 0,void 0,(function*(){var e;"include"===(null!==(e=(yield chrome.storage.local.get(k))[k])&&void 0!==e?e:"exclude")?N.checked=!0:B.checked=!0}))}(),function(){[B,N].forEach((e=>{e.addEventListener("change",(()=>o(this,void 0,void 0,(function*(){e.checked&&(yield chrome.storage.local.set({[k]:e.value}))}))))}))}()}},t={};!function n(o){var d=t[o];if(void 0!==d)return d.exports;var i=t[o]={exports:{}};return e[o].call(i.exports,i,i.exports,n),i.exports}(115)})();