(()=>{"use strict";var e={379:function(e,t){var n=this&&this.__awaiter||function(e,t,n,o){return new(n||(n=Promise))((function(i,d){function l(e){try{c(o.next(e))}catch(e){d(e)}}function a(e){try{c(o.throw(e))}catch(e){d(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(l,a)}c((o=o.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.LocalDatabase=void 0,t.LocalDatabase=class{constructor(){this.STORAGE_KEY="word_entries",this.EXCLUDED_DOMAIN_KEY="excluded_domains",this.INCLUDED_DOMAIN_KEY="included_domains"}getAll(){return n(this,void 0,void 0,(function*(){console.log("Getting all entries from storage...");const e=yield chrome.storage.local.get(this.STORAGE_KEY);return console.log("All entries:",e),e[this.STORAGE_KEY]||[]}))}save(e){return n(this,void 0,void 0,(function*(){const t=yield this.getAll(),n=t.findIndex((t=>t.key===e.key));n>-1?t[n]=e:t.push(e),yield chrome.storage.local.set({[this.STORAGE_KEY]:t})}))}delete(e){return n(this,void 0,void 0,(function*(){const t=(yield this.getAll()).filter((t=>t.key!==e));yield chrome.storage.local.set({[this.STORAGE_KEY]:t})}))}getAllExcludedDomains(){return n(this,void 0,void 0,(function*(){return(yield chrome.storage.local.get(this.EXCLUDED_DOMAIN_KEY))[this.EXCLUDED_DOMAIN_KEY]||[]}))}addExcludedDomain(e){return n(this,void 0,void 0,(function*(){const t=yield this.getAllExcludedDomains();t.some((t=>t.domain===e))||(t.push({domain:e}),yield chrome.storage.local.set({[this.EXCLUDED_DOMAIN_KEY]:t}))}))}removeExcludedDomain(e){return n(this,void 0,void 0,(function*(){const t=(yield this.getAllExcludedDomains()).filter((t=>t.domain!==e));yield chrome.storage.local.set({[this.EXCLUDED_DOMAIN_KEY]:t})}))}getAllIncludedDomains(){return n(this,void 0,void 0,(function*(){return(yield chrome.storage.local.get(this.INCLUDED_DOMAIN_KEY))[this.INCLUDED_DOMAIN_KEY]||[]}))}addIncludedDomain(e){return n(this,void 0,void 0,(function*(){const t=yield this.getAllIncludedDomains();t.some((t=>t.domain===e))||(t.push({domain:e}),yield chrome.storage.local.set({[this.INCLUDED_DOMAIN_KEY]:t}))}))}removeIncludedDomain(e){return n(this,void 0,void 0,(function*(){const t=(yield this.getAllIncludedDomains()).filter((t=>t.domain!==e));yield chrome.storage.local.set({[this.INCLUDED_DOMAIN_KEY]:t})}))}}},115:function(e,t,n){var o=this&&this.__awaiter||function(e,t,n,o){return new(n||(n=Promise))((function(i,d){function l(e){try{c(o.next(e))}catch(e){d(e)}}function a(e){try{c(o.throw(e))}catch(e){d(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(l,a)}c((o=o.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});const i=new(n(379).LocalDatabase);let d=[];const l=document.getElementById("dateFrom"),a=document.getElementById("dateTo"),c=document.getElementById("filterButton"),r=document.getElementById("prioritySort"),s=document.getElementById("wordsContainer");let u=1;const m=document.getElementById("pagination");function v(){return o(this,arguments,void 0,(function*(e={}){let t=yield i.getAll();e.from&&(t=t.filter((t=>new Date(t.addedDate)>=e.from))),e.to&&(t=t.filter((t=>new Date(t.addedDate)<=e.to))),e.prioritySort?t.sort(((t,n)=>"asc"===e.prioritySort?t.priority===n.priority?new Date(t.addedDate).getTime()-new Date(n.addedDate).getTime():t.priority-n.priority:t.priority===n.priority?new Date(n.addedDate).getTime()-new Date(t.addedDate).getTime():n.priority-t.priority)):t.sort(((e,t)=>e.priority===t.priority?new Date(t.addedDate).getTime()-new Date(e.addedDate).getTime():t.priority-e.priority)),d=t,u=1,h()}))}function h(){s.innerHTML="",Math.ceil(d.length/10);const e=10*(u-1),t=e+10;d.slice(e,t).forEach((e=>{!function(e){const t=document.createElement("div");t.className="word-card";const n=document.createElement("div");n.className="word-header";const d=document.createElement("span");d.innerHTML=`<b>${e.key}</b>`,n.appendChild(d);const l=document.createElement("div");l.className="priority-section";const a=document.createElement("label");a.textContent="優先度:",l.appendChild(a);const c=document.createElement("select");c.className="priority-select",[1,2,3,4,5].forEach((t=>{const n=document.createElement("option");n.value=String(t),n.textContent=String(t),t===e.priority&&(n.selected=!0),c.appendChild(n)})),c.addEventListener("change",(()=>o(this,void 0,void 0,(function*(){e.priority=Number(c.value),yield i.save(e),console.log("優先度が変更されました:",e.key,e.priority)})))),l.appendChild(c);const r=document.createElement("button");r.textContent="変更",r.addEventListener("click",(()=>o(this,void 0,void 0,(function*(){e.priority=Number(c.value),yield i.save(e),console.log("優先度が変更されました:",e.priority)})))),l.appendChild(r),n.appendChild(l),t.appendChild(n);const u=document.createElement("ul");u.className="example-list",e.examples.forEach(((t,n)=>{const d=document.createElement("li");d.textContent=t;const l=document.createElement("button");l.textContent="削除",l.style.marginLeft="8px",l.addEventListener("click",(()=>o(this,void 0,void 0,(function*(){e.examples.splice(n,1),yield i.save(e),h()})))),d.appendChild(l),u.appendChild(d)}));const m=document.createElement("button");m.textContent="追加",m.addEventListener("click",(()=>o(this,void 0,void 0,(function*(){const t=prompt("新しい例文を入力してください:");t&&(e.examples.push(t),yield i.save(e),h())})))),t.appendChild(u),t.appendChild(m);const v=document.createElement("div");v.className="note-section";const p=document.createElement("textarea");p.rows=2,p.cols=30,p.value=e.note||"",p.addEventListener("change",(()=>o(this,void 0,void 0,(function*(){e.note=p.value,yield i.save(e),console.log("メモが更新されました:",e.key,e.note)})))),v.appendChild(p),t.appendChild(v);const E=document.createElement("div");E.className="word-links",[{name:"Oxford",url:`https://www.oxfordlearnersdictionaries.com/definition/english/${e.key}`},{name:"Weblio",url:`https://ejje.weblio.jp/content/${e.key}`},{name:"Youglish",url:`https://youglish.com/pronounce/${e.key}/english`},{name:"Play Phrase",url:`https://playphrase.me/#/search?q=${e.key}`}].forEach((({name:e,url:t})=>{const n=document.createElement("a");n.href=t,n.target="_blank",n.textContent=e,E.appendChild(n)})),t.appendChild(E);const y=document.createElement("div");y.style.fontSize="0.8em",y.style.marginTop="5px",y.textContent=`追加日: ${new Date(e.addedDate).toLocaleString()}`,t.appendChild(y),s.appendChild(t)}(e)})),function(){m.innerHTML="";const e=Math.ceil(d.length/10),t=document.createElement("button");t.textContent="前へ",t.className="pagination-button",t.disabled=1===u,t.addEventListener("click",(()=>{u>1&&(u--,h())})),m.appendChild(t);const n=document.createElement("button");n.textContent="次へ",n.className="pagination-button",n.disabled=u===e,n.addEventListener("click",(()=>{u<e&&(u++,h())})),m.appendChild(n)}()}c.addEventListener("click",(()=>{v({from:l.value?new Date(l.value):void 0,to:a.value?new Date(a.value):void 0,prioritySort:r.value})})),r.addEventListener("change",(()=>{v({from:l.value?new Date(l.value):void 0,to:a.value?new Date(a.value):void 0,prioritySort:r.value})}));const p=document.getElementById("newWordKey"),E=document.getElementById("newWordExamples"),y=document.getElementById("newWordNote"),g=document.getElementById("newWordPriority");document.getElementById("addNewWordButton").addEventListener("click",(()=>o(void 0,void 0,void 0,(function*(){const e=p.value.trim();if(!e)return void alert("単語のキーが空です。入力してください。");const t={key:e,examples:E.value.split(",").map((e=>e.trim())).filter((e=>e)),note:y.value||"",priority:Number(g.value)||3,addedDate:(new Date).toISOString()};yield i.save(t),p.value="",E.value="",y.value="",g.value="3",v()}))));const f=document.getElementById("excludedDomainInput"),D=document.getElementById("addExcludedDomainButton"),x=document.getElementById("excludedDomainList");function I(){return o(this,void 0,void 0,(function*(){const e=yield i.getAllExcludedDomains();x.innerHTML="";for(const t of e){const e=document.createElement("li");e.textContent=t.domain;const n=document.createElement("button");n.textContent="削除",n.addEventListener("click",(()=>o(this,void 0,void 0,(function*(){yield i.removeExcludedDomain(t.domain),I()})))),e.appendChild(n),x.appendChild(e)}}))}D.addEventListener("click",(()=>o(void 0,void 0,void 0,(function*(){const e=f.value.trim();e&&(yield i.addExcludedDomain(e),f.value="",I())}))));const C=document.getElementById("includedDomainInput"),L=document.getElementById("addIncludedDomainButton"),w=document.getElementById("includedDomainList");function _(){return o(this,void 0,void 0,(function*(){const e=yield i.getAllIncludedDomains();w.innerHTML="";for(const t of e){const e=document.createElement("li");e.textContent=t.domain;const n=document.createElement("button");n.textContent="削除",n.addEventListener("click",(()=>o(this,void 0,void 0,(function*(){yield i.removeIncludedDomain(t.domain),_()})))),e.appendChild(n),w.appendChild(e)}}))}L.addEventListener("click",(()=>o(void 0,void 0,void 0,(function*(){const e=C.value.trim();e&&(yield i.addIncludedDomain(e),C.value="",_())}))));const k="domainFilterMode",N=document.getElementById("radioExclude"),A=document.getElementById("radioInclude"),b=document.getElementById("excludeSettings"),B=document.getElementById("includeSettings");function M(e){"exclude"===e?(b.style.display="block",B.style.display="none"):(b.style.display="none",B.style.display="block"),localStorage.setItem("domainFilterMode",e)}N.addEventListener("change",(()=>M("exclude"))),A.addEventListener("change",(()=>M("include"))),"exclude"===(localStorage.getItem("domainFilterMode")||"include")?(N.checked=!0,M("exclude")):(A.checked=!0,M("include")),I(),_(),v(),function(){o(this,void 0,void 0,(function*(){var e;"include"===(null!==(e=(yield chrome.storage.local.get(k))[k])&&void 0!==e?e:"exclude")?A.checked=!0:N.checked=!0}))}(),function(){[N,A].forEach((e=>{e.addEventListener("change",(()=>o(this,void 0,void 0,(function*(){e.checked&&(yield chrome.storage.local.set({[k]:e.value}))}))))}))}()}},t={};!function n(o){var i=t[o];if(void 0!==i)return i.exports;var d=t[o]={exports:{}};return e[o].call(d.exports,d,d.exports,n),d.exports}(115)})();