(()=>{"use strict";var e={379:function(e,t){var n=this&&this.__awaiter||function(e,t,n,o){return new(n||(n=Promise))((function(i,d){function l(e){try{c(o.next(e))}catch(e){d(e)}}function a(e){try{c(o.throw(e))}catch(e){d(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(l,a)}c((o=o.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.LocalDatabase=void 0,t.LocalDatabase=class{constructor(){this.STORAGE_KEY="word_entries",this.EXCLUDED_DOMAIN_KEY="excluded_domains",this.INCLUDED_DOMAIN_KEY="included_domains"}getAll(){return n(this,void 0,void 0,(function*(){console.log("Getting all entries from storage...");const e=yield chrome.storage.local.get(this.STORAGE_KEY);return console.log("All entries:",e),e[this.STORAGE_KEY]||[]}))}save(e){return n(this,void 0,void 0,(function*(){const t=yield this.getAll(),n=t.findIndex((t=>t.key===e.key));n>-1?t[n]=e:t.push(e),yield chrome.storage.local.set({[this.STORAGE_KEY]:t})}))}delete(e){return n(this,void 0,void 0,(function*(){const t=(yield this.getAll()).filter((t=>t.key!==e));yield chrome.storage.local.set({[this.STORAGE_KEY]:t})}))}getAllExcludedDomains(){return n(this,void 0,void 0,(function*(){return(yield chrome.storage.local.get(this.EXCLUDED_DOMAIN_KEY))[this.EXCLUDED_DOMAIN_KEY]||[]}))}addExcludedDomain(e){return n(this,void 0,void 0,(function*(){const t=yield this.getAllExcludedDomains();t.some((t=>t.domain===e))||(t.push({domain:e}),yield chrome.storage.local.set({[this.EXCLUDED_DOMAIN_KEY]:t}))}))}removeExcludedDomain(e){return n(this,void 0,void 0,(function*(){const t=(yield this.getAllExcludedDomains()).filter((t=>t.domain!==e));yield chrome.storage.local.set({[this.EXCLUDED_DOMAIN_KEY]:t})}))}getAllIncludedDomains(){return n(this,void 0,void 0,(function*(){return(yield chrome.storage.local.get(this.INCLUDED_DOMAIN_KEY))[this.INCLUDED_DOMAIN_KEY]||[]}))}addIncludedDomain(e){return n(this,void 0,void 0,(function*(){const t=yield this.getAllIncludedDomains();t.some((t=>t.domain===e))||(t.push({domain:e}),yield chrome.storage.local.set({[this.INCLUDED_DOMAIN_KEY]:t}))}))}removeIncludedDomain(e){return n(this,void 0,void 0,(function*(){const t=(yield this.getAllIncludedDomains()).filter((t=>t.domain!==e));yield chrome.storage.local.set({[this.INCLUDED_DOMAIN_KEY]:t})}))}}},115:function(e,t,n){var o=this&&this.__awaiter||function(e,t,n,o){return new(n||(n=Promise))((function(i,d){function l(e){try{c(o.next(e))}catch(e){d(e)}}function a(e){try{c(o.throw(e))}catch(e){d(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(l,a)}c((o=o.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});const i=new(n(379).LocalDatabase);let d=[];const l=document.getElementById("dateFrom"),a=document.getElementById("dateTo"),c=document.getElementById("filterButton"),r=document.getElementById("prioritySort"),s=document.getElementById("wordsTableBody");function u(){return o(this,arguments,void 0,(function*(e={}){let t=yield i.getAll();e.from&&(t=t.filter((t=>new Date(t.addedDate)>=e.from))),e.to&&(t=t.filter((t=>new Date(t.addedDate)<=e.to))),e.prioritySort?t.sort(((t,n)=>"asc"===e.prioritySort?t.priority===n.priority?new Date(t.addedDate).getTime()-new Date(n.addedDate).getTime():t.priority-n.priority:t.priority===n.priority?new Date(n.addedDate).getTime()-new Date(t.addedDate).getTime():n.priority-t.priority)):t.sort(((e,t)=>e.priority===t.priority?new Date(t.addedDate).getTime()-new Date(e.addedDate).getTime():t.priority-e.priority)),d=t,m=1,y()}))}r.addEventListener("change",(()=>{u({from:l.value?new Date(l.value):void 0,to:a.value?new Date(a.value):void 0,prioritySort:r.value})}));let m=1;const h=10,v=document.getElementById("pagination");function p(){v.innerHTML="";const e=Math.ceil(d.length/h),t=document.createElement("button");t.textContent="前へ",t.className="pagination-button",t.disabled=1===m,t.addEventListener("click",(()=>{m>1&&(m--,y(),p())})),v.appendChild(t);const n=document.createElement("button");n.textContent="次へ",n.className="pagination-button",n.disabled=m===e,n.addEventListener("click",(()=>{m<e&&(m++,y(),p())})),v.appendChild(n)}function y(){s.innerHTML="",Math.ceil(d.length/h);const e=(m-1)*h,t=e+h,n=d.slice(e,t);for(const l of n){const a=document.createElement("tr"),c=`https://youglish.com/pronounce/${encodeURIComponent(l.key)}/english`,r=`https://playphrase.me/#/search?q=${encodeURIComponent(l.key)}`,v=`https://www.oxfordlearnersdictionaries.com/definition/english/${encodeURIComponent(l.key)}`,E=`https://ejje.weblio.jp/content/${encodeURIComponent(l.key)}`,g=`https://www.yourdictionary.com/${encodeURIComponent(l.key)}`,f=`https://hypcol.marutank.net/?q=${encodeURIComponent(l.key)}&d=f`,D=document.createElement("td");D.className="key-cell";const C=document.createElement("span");C.textContent=l.key;const I=document.createElement("button");I.textContent="編集",I.addEventListener("click",(()=>{const e=document.createElement("input");e.type="text",e.value=l.key,e.className="edit-key-input",C.classList.add("hidden"),I.classList.add("hidden"),D.appendChild(e),e.focus();const t=()=>o(this,void 0,void 0,(function*(){const t=e.value.trim();if(t&&t!==l.key){const e=l.key;l.key=t,yield i.delete(e),yield i.save(l),console.log("キーを更新しました:",e,"->",t)}D.removeChild(e),C.textContent=l.key,C.classList.remove("hidden"),I.classList.remove("hidden"),y()}));e.addEventListener("keydown",(e=>{"Enter"===e.key&&t()})),e.addEventListener("blur",(()=>{t()}))})),D.appendChild(C),D.appendChild(I);const x=document.createElement("td");x.className="link-cell",x.innerHTML=`\n      <ul>\n        <li><a href="${v}" target="_blank">Ox.</a></li>\n        <li><a href="${E}" target="_blank">We.</a></li>\n      </ul>\n    `;const k=document.createElement("td");k.className="link-cell",k.innerHTML=`\n      <ul>\n        <li><a href="${c}" target="_blank">Youglish</a></li>\n        <li><a href="${r}" target="_blank">P.P.</a></li>\n      </ul>\n    `;const L=document.createElement("td");L.className="link-cell",L.innerHTML=`\n      <ul>\n        <li><a href="${g}" target="_blank">Y.D.</a></li>\n        <li><a href="${f}" target="_blank">H.D.</a></li>\n      </ul>\n    `;const _=document.createElement("td"),w=document.createElement("ul");function b(){w.innerHTML="",l.examples.forEach(((e,t)=>{const n=document.createElement("li");n.textContent=e;const d=document.createElement("button");d.textContent="削除",d.style.marginLeft="8px",d.addEventListener("click",(()=>o(this,void 0,void 0,(function*(){l.examples.splice(t,1),yield i.save(l),y()})))),n.appendChild(d),w.appendChild(n)}))}b();const A=document.createElement("button");A.textContent="追加",A.addEventListener("click",(()=>o(this,void 0,void 0,(function*(){const e=prompt("新しい例文を入力してください:");e&&(l.examples.push(e),yield i.save(l),y())})))),_.appendChild(w),_.appendChild(A);const N=document.createElement("td"),B=document.createElement("textarea");B.className="note-area",B.value=l.note||"",B.rows=2,B.cols=30,B.addEventListener("change",(()=>o(this,void 0,void 0,(function*(){l.note=B.value,yield i.save(l),console.log("メモを保存しました:",l.note)})))),N.appendChild(B);const M=document.createElement("td");M.textContent=new Date(l.addedDate).toLocaleString();const T=document.createElement("td"),O=document.createElement("select");[1,2,3,4,5].forEach((e=>{const t=document.createElement("option");t.value=String(e),t.textContent=String(e),e===l.priority&&(t.selected=!0),O.appendChild(t)})),O.addEventListener("change",(()=>o(this,void 0,void 0,(function*(){l.priority=Number(O.value),yield i.save(l),console.log("優先度を保存しました:",l.priority)})))),T.appendChild(O);const S=document.createElement("td"),Y=document.createElement("button");Y.textContent="削除",Y.addEventListener("click",(()=>o(this,void 0,void 0,(function*(){yield i.delete(l.key),u()})))),S.appendChild(Y),a.appendChild(D),a.appendChild(x),a.appendChild(k),a.appendChild(L),a.appendChild(_),a.appendChild(N),a.appendChild(M),a.appendChild(T),a.appendChild(S),s.appendChild(a)}p()}c.addEventListener("click",(()=>{u({from:l.value?new Date(l.value):void 0,to:a.value?new Date(a.value):void 0,prioritySort:r.value})}));const E=document.getElementById("newWordKey"),g=document.getElementById("newWordExamples"),f=document.getElementById("newWordNote"),D=document.getElementById("newWordPriority");document.getElementById("addNewWordButton").addEventListener("click",(()=>o(void 0,void 0,void 0,(function*(){const e=E.value.trim();if(!e)return void alert("単語のキーが空です。入力してください。");const t={key:e,examples:g.value.split(",").map((e=>e.trim())).filter((e=>e)),note:f.value||"",priority:Number(D.value)||3,addedDate:(new Date).toISOString()};yield i.save(t),E.value="",g.value="",f.value="",D.value="3",u()}))));const C=document.getElementById("excludedDomainInput"),I=document.getElementById("addExcludedDomainButton"),x=document.getElementById("excludedDomainList");function k(){return o(this,void 0,void 0,(function*(){const e=yield i.getAllExcludedDomains();x.innerHTML="";for(const t of e){const e=document.createElement("li");e.textContent=t.domain;const n=document.createElement("button");n.textContent="削除",n.addEventListener("click",(()=>o(this,void 0,void 0,(function*(){yield i.removeExcludedDomain(t.domain),k()})))),e.appendChild(n),x.appendChild(e)}}))}I.addEventListener("click",(()=>o(void 0,void 0,void 0,(function*(){const e=C.value.trim();e&&(yield i.addExcludedDomain(e),C.value="",k())}))));const L=document.getElementById("includedDomainInput"),_=document.getElementById("addIncludedDomainButton"),w=document.getElementById("includedDomainList");function b(){return o(this,void 0,void 0,(function*(){const e=yield i.getAllIncludedDomains();w.innerHTML="";for(const t of e){const e=document.createElement("li");e.textContent=t.domain;const n=document.createElement("button");n.textContent="削除",n.addEventListener("click",(()=>o(this,void 0,void 0,(function*(){yield i.removeIncludedDomain(t.domain),b()})))),e.appendChild(n),w.appendChild(e)}}))}_.addEventListener("click",(()=>o(void 0,void 0,void 0,(function*(){const e=L.value.trim();e&&(yield i.addIncludedDomain(e),L.value="",b())}))));const A="domainFilterMode",N=document.getElementById("radioExclude"),B=document.getElementById("radioInclude"),M=document.getElementById("excludeSettings"),T=document.getElementById("includeSettings");function O(e){"exclude"===e?(M.style.display="block",T.style.display="none"):(M.style.display="none",T.style.display="block"),localStorage.setItem("domainFilterMode",e)}N.addEventListener("change",(()=>O("exclude"))),B.addEventListener("change",(()=>O("include"))),"exclude"===(localStorage.getItem("domainFilterMode")||"include")?(N.checked=!0,O("exclude")):(B.checked=!0,O("include")),k(),b(),u(),function(){o(this,void 0,void 0,(function*(){var e;"include"===(null!==(e=(yield chrome.storage.local.get(A))[A])&&void 0!==e?e:"exclude")?B.checked=!0:N.checked=!0}))}(),function(){[N,B].forEach((e=>{e.addEventListener("change",(()=>o(this,void 0,void 0,(function*(){e.checked&&(yield chrome.storage.local.set({[A]:e.value}))}))))}))}()}},t={};!function n(o){var i=t[o];if(void 0!==i)return i.exports;var d=t[o]={exports:{}};return e[o].call(d.exports,d,d.exports,n),d.exports}(115)})();